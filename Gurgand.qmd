---
title: "Gurgand"
author: "Leon Gurgand"
format: html
editor: visual
---

## 1.1) Study organisation

### Q1)

```{r}
library(here)
library(ggplot2)
library(vroom)
library(dplyr)
library(tidyr)
library(knitr)
library(readr)
here::i_am("grades-eval.Rproj")
```

```{r}
#|eval: false
courses <- read.csv(here("subject-8","courses.csv"))
```

### Q2)

```{r}
courses_renamed <- courses |>
  rename(
    course = course,
    identifier = course_id,
    module = module,
    number_of_exams = nb_grades
  ) |>
  arrange(course)

kable(courses_renamed)
```

## 1.2) Students

### Q3)

```{r}
students <- read.csv(here("subject-8","students.csv"))
```

```{r}
students <- students |>
  mutate(
    birth_date = as.Date(birth_date), 
    sex = as.factor(sex)
  )
```

```{r}
class(students$birth_date)
class(students$sex)
```

## 1.3) Grades

### Q4)
```{r}
grades_clean <- read_delim(here("subject-8","grades.csv"),
  delim = ":",
  na = "$"
)
```

## 2) Student population analysis
### Q5)

```{r}
ggplot(students, aes(x = factor(group))) +
  geom_bar() +
  labs(
    title = "Number of Students per Group",
    x = "Group",
    y = "Number of Students"
  )
```

### Q6)

```{r}
ggplot(students, aes(x = factor(group), fill = sex)) +
  geom_bar(position = "fill") +
  labs(
    title = "Gender Balance per Group",
    x = "Group",
    y = "Percentage of Students",
    fill = "Gender"
  )
```

### Q7)

```{r}
library(lubridate)
students_age <- students |>
  mutate(age = time_length(today() - birth_date, unit = "year"))

ggplot(students_age, aes(x = age)) +
  geom_histogram(binwidth = 1) +
  labs(
    title = "Distribution of Student Ages",
    x = "Age (years)",
    y = "Number of students"
  )
```

### Q8)

```{r}
median_age_by_group <- students_age |>
  group_by(group) |>
  summarise(median_age = median(age, na.rm = TRUE)) |>
  arrange(group)

kable(median_age_by_group, 
      col.names = c("Group", "Median Age"), 
      caption = "Median Age of Students by Group")
```

### Q9)

```{r}
oldest_per_group <- students_age |>
  group_by(group) |>
  slice_max(age, n = 1, with_ties = FALSE) |>
  ungroup() |>
  select(id, sex, age, group) |>
  arrange(desc(age))

kable(oldest_per_group, 
      col.names = c("ID", "Sex", "Age", "Group"), 
      caption = "Oldest Student in Each Group")
```


